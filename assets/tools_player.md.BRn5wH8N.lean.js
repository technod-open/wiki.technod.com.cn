import{_ as b,u as T,h as _,p as d,v as q,c as V,o as B,j as t,af as m,ag as C,a as y,ah as E}from"./chunks/framework.BGjk28iD.js";const I={class:"player-content"},M={class:"nav-tab",style:{display:"flex",width:"94%"}},O={style:{flex:"0.4","padding-top":"10px","padding-bottom":"10px","padding-right":"10px"}},j={style:{flex:"1",padding:"10px"}},z=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"tools/player.md","filePath":"tools/player.md"}'),k={name:"tools/player.md"},D=Object.assign(k,{setup(H){const{page:v}=T(),f=_(()=>v.value.relativePath),l=d("https://dcdn.nodjoy.com/demo/index.m3u8"),s=d("m3u8"),i=d("https://cdn.nodjoy.com/images/5cf8c5d9c57b510947.png"),g=()=>{alert("如果播放地址是http协议, 请访问http://wiki.nodjoy.com/tools/player.html")},h=()=>{if(!l.value||!(l.value.startsWith("https://")||l.value.startsWith("http://"))){alert("请输入有效的播放地址");return}const a=document.getElementById("dplayer");a&&a.remove();const e=document.createElement("div");e.id="dplayer",document.querySelector(".player-content").appendChild(e),document.querySelector(".player-content  #dplayer").style.width="94%",document.querySelector(".player-content  #dplayer").style.margin="0 auto",setTimeout(()=>{c(!0)},1e3);const o=document.getElementById("vcomments");o&&o.remove();const n=document.createElement("div");n.id="vcomments",document.querySelector(".player-content").appendChild(n),document.querySelector(".player-content  #vcomments").style.width="94%",document.querySelector(".player-content  #vcomments").style.margin="0 auto",document.querySelector(".player-content  #vcomments").style.marginTop="20px",setTimeout(()=>{p()},500)},x=()=>!!s.value.includes("live"),w=(a,e)=>{switch(e){case"mp4":return{url:a,pic:i.value,type:"video/mp4"};case"m3u8":case"live-m3u8":return{url:a,pic:i.value,type:"customHls",customType:{customHls:function(o,n){const r=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,S=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(r||S){o.removeAttribute("src"),o.src=a,o.load(),n.on("play",function(){o.play().catch(P=>{console.log("iOS playback error:",P)})});return}const u=new Hls;u.loadSource(o.src),u.attachMedia(o)}}};case"live-flv":return{url:a,pic:i.value,type:"customFlv",customType:{customFlv:function(o,n){const r=flvjs.createPlayer({type:"flv",url:o.src});r.attachMediaElement(o),r.load()}}}}},c=a=>{const e=new DPlayer({container:document.getElementById("dplayer"),live:x(),video:w(l.value,s.value)});a&&e.play()},p=async()=>{typeof Valine<"u"&&new Valine({el:"#vcomments",appId:"9iOmqWQl7wQBsarOb3o2m0eO-gzGzoHsz",appKey:"U2cCMaQisH6I3GsyClKuvrwK",path:f.value,avatar:"wavatar",avatar_cdn:"https://cravatar.cn/avatar/",visitor:!0})};return q(()=>{try{DPlayer&&c()}catch{setTimeout(()=>{DPlayer&&c()},1e3)}setTimeout(()=>{p()},1e3)}),(a,e)=>(B(),V("div",null,[t("div",I,[t("div",M,[t("div",O,[e[3]||(e[3]=t("label",null,"选择播放类型：",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),style:{cursor:"pointer"}},[...e[2]||(e[2]=[t("option",{value:"m3u8"},"m3u8",-1),t("option",{value:"mp4"},"mp4/mp3",-1),t("option",{value:"live-m3u8"},"直播流-m3u8",-1),t("option",{value:"live-flv"},"直播流-flv",-1)])],512),[[C,s.value]])]),t("div",j,[t("label",null,[e[4]||(e[4]=y("播放地址",-1)),t("span",{onClick:g,style:{cursor:"pointer"}},"ℹ️"),e[5]||(e[5]=y("：",-1))]),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),style:{width:"80%"}},null,512),[[E,l.value]])]),t("div",{style:{flex:"0.4",padding:"10px"}},[t("button",{onClick:h},"点击播放")])]),e[6]||(e[6]=t("div",{id:"dplayer"},null,-1)),e[7]||(e[7]=t("div",{id:"vcomments"},null,-1))])]))}}),A=b(D,[["__scopeId","data-v-3bb7b8de"]]);export{z as __pageData,A as default};
