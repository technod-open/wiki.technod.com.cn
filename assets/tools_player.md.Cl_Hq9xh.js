import{_ as T,u as b,h as _,p as u,v as q,c as H,o as M,j as o,af as m,ag as V,a as y,ah as B}from"./chunks/framework.BGjk28iD.js";const C={class:"player-content"},E={class:"nav-tab",style:{display:"flex",width:"94%"}},I={style:{flex:"0.4","padding-top":"10px","padding-bottom":"10px","padding-right":"10px"}},O={style:{flex:"1",padding:"10px"}},z=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"page"},"headers":[],"relativePath":"tools/player.md","filePath":"tools/player.md"}'),j={name:"tools/player.md"},k=Object.assign(j,{setup(D){const{page:v}=b(),f=_(()=>v.value.relativePath),n=u("https://dcdn.nodjoy.com/demo/index.m3u8"),r=u("m3u8"),i=u("https://cdn.nodjoy.com/images/5cf8c5d9c57b510947.png"),g=()=>{alert("如果播放地址是http协议，请访问http://wiki.nodjoy.com/tools/player.html")},h=()=>{if(!n.value||!(n.value.startsWith("https://")||n.value.startsWith("http://"))){alert("请输入有效的播放地址");return}const a=document.getElementById("dplayer");a&&a.remove();const e=document.createElement("div");e.id="dplayer",document.querySelector(".player-content").appendChild(e),document.querySelector(".player-content  #dplayer").style.width="94%",document.querySelector(".player-content  #dplayer").style.margin="0 auto",setTimeout(()=>{c(!0)},1e3);const t=document.getElementById("vcomments");t&&t.remove();const s=document.createElement("div");s.id="vcomments",document.querySelector(".player-content").appendChild(s),document.querySelector(".player-content  #vcomments").style.width="94%",document.querySelector(".player-content  #vcomments").style.margin="0 auto",document.querySelector(".player-content  #vcomments").style.marginTop="20px",setTimeout(()=>{p()},500)},w=()=>!!r.value.includes("live"),x=(a,e)=>{switch(e){case"mp4":return{url:a,pic:i.value,type:"video/mp4"};case"m3u8":return{url:a,pic:i.value,type:"customHls",customType:{customHls:function(t,s){const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,S=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(l||S){t.removeAttribute("src"),t.src=a,t.load(),s.on("play",function(){t.play().catch(P=>{console.log("iOS playback error:",P)})});return}const d=new Hls;d.loadSource(t.src),d.attachMedia(t)}}};case"live-m3u8":return{url:a,pic:i.value,type:"customHls",live:!0,customType:{customHls:function(t,s){const l=new Hls;l.loadSource(t.src),l.attachMedia(t)}}};case"live-flv":return{url:a,pic:i.value,type:"customFlv",customType:{customFlv:function(t,s){const l=flvjs.createPlayer({type:"flv",url:t.src});l.attachMediaElement(t),l.load()}}}}},c=a=>{const e=new DPlayer({container:document.getElementById("dplayer"),live:w(),video:x(n.value,r.value)});a&&e.play()},p=async()=>{typeof Valine<"u"&&new Valine({el:"#vcomments",appId:"9iOmqWQl7wQBsarOb3o2m0eO-gzGzoHsz",appKey:"U2cCMaQisH6I3GsyClKuvrwK",path:f.value,avatar:"wavatar",avatar_cdn:"https://cravatar.cn/avatar/",visitor:!0})};return q(()=>{try{DPlayer&&c()}catch{setTimeout(()=>{DPlayer&&c()},1e3)}setTimeout(()=>{p()},1e3)}),(a,e)=>(M(),H("div",null,[o("div",C,[o("div",E,[o("div",I,[e[3]||(e[3]=o("label",null,"选择播放类型：",-1)),m(o("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),style:{cursor:"pointer"}},[...e[2]||(e[2]=[o("option",{value:"m3u8"},"m3u8",-1),o("option",{value:"mp4"},"mp4/mp3",-1),o("option",{value:"live-m3u8"},"直播流-m3u8",-1),o("option",{value:"live-flv"},"直播流-flv",-1)])],512),[[V,r.value]])]),o("div",O,[o("label",null,[e[4]||(e[4]=y("播放地址",-1)),o("span",{onClick:g,style:{cursor:"pointer"}},"ℹ️"),e[5]||(e[5]=y("：",-1))]),m(o("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),style:{width:"80%"}},null,512),[[B,n.value]])]),o("div",{style:{flex:"0.4",padding:"10px"}},[o("button",{onClick:h},"点击播放")])]),e[6]||(e[6]=o("div",{id:"dplayer"},null,-1)),e[7]||(e[7]=o("div",{id:"vcomments"},null,-1))])]))}}),A=T(k,[["__scopeId","data-v-3648461c"]]);export{z as __pageData,A as default};
